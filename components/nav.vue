<template>
 <nav class="navbar" :style="style">
    <div class="container">
      <div class="navbar-brand">
          <a  href="/home" class="navbar-item logo">
            <img src="/images/logo.png" alt="City of London JavaScript Conference logo" />
          </a>
          <span class="navbar-burger" v-on:click="toggleNav" v-bind:class="{ 'is-active': isActive }">
            <span></span>
            <span></span>
            <span></span>
          </span>
      </div>
      <div  class="navbar-end navbar-menu" :class="{ 'is-active': isActive }"  :style="style">
        <div class="navbar-item is-active">
            <nuxt-link 
              v-if="item.hide === 'No' && item.isRedirect  === 'No'" 
              class="navbar-item r-item" 
              :key="item.id" 
              :to="`/${item.url}`"
               v-for="item in items"
            >
              {{item.title}}
            </nuxt-link>
            <a
              class="navbar-item r-item is-info " 
              :class="{ button: item.color==='button' }"
              v-for="item in items"
              data-toggle="collapse" 
              data-target=".navbar-collapse.show"
              v-if="item.hide === 'No' && item.isRedirect === 'Yes'" 
              :href="`/${item.url}`"
              :key="item.id" 
            >
            {{item.title}}
            </a>
        </div>
      </div>
    </div>
  </nav>
  <!-- END NAV -->
</template>
<style>
/* You can get the component styles from the Github repository for this demo */
</style>
<script>
import { mapGetters } from 'vuex'
export default {
  data: function() {
    return {
      isActive: false,
      scroll: false
    }
  },
  methods: {
    toggleNav: function() {
      this.isActive = !this.isActive;
    },
    handleScroll: function() {
      if(window.scrollY > 10) {
        this.scroll = true;
      } else  {
        this.scroll = false;
      }
    }
  },
  computed: {
    ...mapGetters({
      pages: 'pages/pages',
    }),
    style () {
      return (this.scroll) ? "background-color: #000 !important; color: #fff ;" : ""
    }
  },
  destroyed () {
    if (process.browser) { 
      window.removeEventListener('scroll', this.handleScroll);
    }
  },
  created () {
    if (process.browser) { 
      window.addEventListener('scroll', this.handleScroll);
    }

    this.$store.watch(
      (state, getters) => getters.pages,
      (newValue, oldValue) => {
       console.log(newValue);
       console.log(oldValue);
      },
    );
  },
  watch:{
    $route (to, from){
      this.isActive= false;
    }
  },
  props: {
    items: {
      type: Array
    }
  }
};
</script>
<style lang="sass">
  @import '~/assets/css/mq.sass';

  .navbar-item
    +mobile
      background: $white;
      color: $black;
    +ipadpro
      color: $white;
  .logo 
    +mobile
      background: transparent;
      
  .navbar
    position: fixed;
    top: 0;
    right: 0;
    left: 0;
    z-index: 1030;
    background-color: transparent !important;
    a:hover
      text-decoration: underlined;
    a:focus
      background: transparent;
      color: #fff;

  a.r-item
    color: $white;
    font-weight: bold;
    font-size: 0.9rem;
    text-transform: uppercase;
    padding: 0.5rem 1.75rem
    &:hover
      background: none;
      color: $white;
    +mobile
      color: $black
    +ipadpro
      color: $white;

  .navbar-burger
    &:hover
      background-color: #F1F1F1
    span
      background-color: #fff
      font-weight: bold


</style>